const mongoose = require('mongoose');

var DataElement = require('./basetypes/DataElement');
var Schema = mongoose.Schema;
var Code = Schema.Types.Code;
var Interval = Schema.Types.Interval;
var Quantity = Schema.Types.Quantity;
var Integer = Schema.Types.Integer;
var Array = Schema.Types.Array;
var String = Schema.Types.String;
var Float = Schema.Types.Float;
var Time = Schema.Types.Time;

var <%= datatype -%>Schema = DataElement.extendSchema(DataElement.DataElementSchema, {
  <%- for attribute in attrs_with_extras -%>
  <%- if attrs_with_extras.last[:name] == attribute[:name] -%>
  <%= attribute[:name].underscore %>: <%= TYPE_LOOKUP[attribute[:type]] -%>
  <%- else -%>
  <%= attribute[:name].underscore %>: <%= TYPE_LOOKUP[attribute[:type]] -%>,
  <%- end -%>
  <%- end %>
});

module.exports = mongoose.model("<%= datatype %>", <%= datatype %>Schema);
